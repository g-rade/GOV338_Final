---
title: "sandy_net.Rmd"
author: "Grace Rade"
date: "2023-04-18"
output: html_document
---
```{r}
library(tidyverse)
library(rio)
library(statnet)

sandy_dyads <- import("sandy_dyads.csv")

sandy_relief <- import("sandy2014.csv") 

sandy_relief <- sandy_relief %>% 
  mutate(name = substr(name, 6,nchar(sandy_relief$name)-15)) %>% 
  mutate(storm = ifelse(state %in% c("PA", "MA", "NH", "WV", "WA", "MD", "DE", "RI", "CT", "NJ", "NY"), 1, 0))

library(network) ## load network

sandy_sens <- nrow(sandy_relief)
net_sandy <-network.initialize(sandy_sens, directed = F) ## initialize an empty network

network.vertex.names(x=net_sandy) <- sandy_relief$name ## name the vertices

sandy_el <- sandy_dyads %>% 
  select(name, name2)

net_sandy[as.matrix(sandy_el)] <- 1 

#set.vertex.attribute(x=net_sandy,attrname="Storm",val=sandy_dyads$storm) ## not a directed network (remove arrows manually)

##

plot(net_sandy) ## use this code

## community detection algorithm first, then do modularity (subgroup analysis first)

## could also filter the edge list based on storm 

```

```{r}
## trying from igraph
library(igraph)
sandy_net <- graph_from_data_frame(sandy_el, directed = F) ## this is a 
plot(sandy_net, vertex.size = 5, alpha = 0.1, vertex.color = sandy_relief$storm, edge.color = sandy_dyads$cross_party) ## this is a really ugly plot, can't get it to spread out, can't get everything to be bigger, also i can change the color but cannot specify which ones I want
modularity(sandy_net) ## I can't get this to work

## community detection algorithm first, then do modularity
```

